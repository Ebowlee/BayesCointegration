# å›žæµ‹é—®é¢˜æ¸…å• - v6.4.0

**å›žæµ‹ID**: `7f9b49959f3276f3901524dfee66acb4`
**å›žæµ‹æœŸ**: 2024å¹´6æœˆ20æ—¥ - 2024å¹´9æœˆ20æ—¥ (3ä¸ªæœˆ)
**æ€»æ”¶ç›Š**: -1.41% (-$1,414.93)
**åˆ›å»ºæ—¥æœŸ**: 2025å¹´9æœˆ30æ—¥

---

## é—®é¢˜ä¼˜å…ˆçº§

### ðŸ”´ ä¼˜å…ˆçº§1 - ç´§æ€¥Bug (åŠŸèƒ½ç¼ºé™·)

#### ~~é—®é¢˜1: Cooldownæœºåˆ¶åœ¨å¼ºåˆ¶æ¸…ç®—åŽå¤±æ•ˆ~~ [âœ… å·²ä¿®å¤]

**ä¸¥é‡ç¨‹åº¦**: ðŸ”´ Critical
**å½±å“**: å¯¼è‡´AMZNè¢«äº¤æ˜“14æ¬¡,ä¸¥é‡è¿åcooldownè§„åˆ™

**é—®é¢˜æè¿°**:
- æ­£å¸¸å¹³ä»“åŽcooldownç”Ÿæ•ˆ (å¦‚7/23å¹³ä»“åŽ44å¤©æ‰å¼€æ–°ä»“)
- å¼ºåˆ¶æ¸…ç®—åŽcooldownå¤±æ•ˆ (9æœˆä»½4æ¬¡æ¸…ç®—åŽ1-2å¤©å°±å¼€æ–°ä»“)

**æ ¹æœ¬åŽŸå› **:
```python
# æ­£å¸¸å¹³ä»“ - æœ‰Tag,cooldownç”Ÿæ•ˆ âœ…
def close_position(self):
    tag = self.create_order_tag(OrderAction.CLOSE)  # "pair_id_CLOSE_20240709"
    self.algorithm.Liquidate(self.symbol1, tag=tag)

# å¼ºåˆ¶æ¸…ç®— - æ— Tag,cooldownå¤±æ•ˆ âŒ
# main.py:256-258
self.Liquidate(pair.symbol1)  # æ²¡æœ‰Tag!
self.Liquidate(pair.symbol2)
```

**æ£€æµ‹é€»è¾‘**:
- `get_exit_time()` é€šè¿‡æŸ¥æ‰¾Tagä¸­åŒ…å«"CLOSE"çš„è®¢å•æ¥ç¡®å®šé€€å‡ºæ—¶é—´
- å¼ºåˆ¶æ¸…ç®—çš„è®¢å•æ²¡æœ‰"CLOSE"æ ‡è®°,å¯¼è‡´æ‰¾ä¸åˆ°é€€å‡ºæ—¶é—´
- `is_in_cooldown()` è¿”å›žFalse,å…è®¸ç«‹å³å¼€æ–°ä»“

**å½±å“æ•°æ®**:
- AMZN-CMGé…å¯¹: 5æ¬¡cooldownè¿è§„ (7/19è¾¹ç•Œ, 9/10, 9/13, 9/18)
- AMZN-GMé…å¯¹: 1æ¬¡cooldownè¿è§„ (9/5)
- æ€»è®¡: 6æ¬¡è¿è§„,å¯¼è‡´14æ¬¡AMZNäº¤æ˜“

**ä¿®å¤æ–¹æ¡ˆ**: æ–¹æ¡ˆA - ç»Ÿä¸€ä½¿ç”¨`pair.close_position()`

**ä¿®å¤è®°å½•**:

**ç¬¬ä¸€æ¬¡ä¿®å¤** (2025å¹´9æœˆ30æ—¥ - éƒ¨åˆ†ç”Ÿæ•ˆ):
- ä¿®æ”¹æ–‡ä»¶: main.py (3å¤„ä¿®æ”¹)
- ä¿®æ”¹ä½ç½®:
  - Line 256: æŒä»“è¶…æœŸæ¸…ä»“
  - Line 264: æŒä»“å¼‚å¸¸æ¸…ä»“
  - Line 271: é…å¯¹å›žæ’¤æ¸…ä»“
- ä¿®æ”¹å†…å®¹: å°†`self.Liquidate(pair.symbol1/2)`æ”¹ä¸º`pair.close_position()`
- **å›žæµ‹ç»“æžœ**: å›žæµ‹ID `1554da274ce47117b380957827b40897`
  - AMZNäº¤æ˜“æ¬¡æ•°: 14æ¬¡ â†’ 7æ¬¡ (âœ… å‡å°‘50%)
  - Cooldownåˆè§„çŽ‡: 90% (9/10é…å¯¹éµå®ˆ)
  - **æ®‹ç•™é—®é¢˜**: 9/4å¼ºåˆ¶æ¸…ç®—åŽ9/5ä»è¿è§„å¼€ä»“

**ç¬¬äºŒæ¬¡ä¿®å¤** (2025å¹´9æœˆ30æ—¥ - æ ¹æœ¬è§£å†³):
- ä¿®æ”¹æ–‡ä»¶: src/Pairs.py
- ä¿®æ”¹ä½ç½®: Line 231-260 (close_positionæ–¹æ³•)
- **æ ¹æœ¬é—®é¢˜å‘çŽ°**: `Liquidate()`æ–¹æ³•ä¸æ”¯æŒtagå‚æ•°!
  ```python
  # âŒ ç¬¬ä¸€æ¬¡ä¿®å¤çš„é—®é¢˜
  self.algorithm.Liquidate(self.symbol1, tag=tag)  # tagå‚æ•°è¢«å¿½ç•¥!

  # âœ… ç¬¬äºŒæ¬¡ä¿®å¤çš„æ–¹æ¡ˆ
  self.algorithm.MarketOrder(self.symbol1, -qty1, tag=tag)  # æ­£ç¡®æ”¯æŒtag
  ```
- **ä¿®æ”¹å†…å®¹**:
  - æ”¹ç”¨`MarketOrder(symbol, -quantity, tag=tag)`æ›¿ä»£`Liquidate()`
  - å¢žåŠ æŒä»“æ£€æŸ¥,é¿å…å¯¹0æŒä»“ä¸‹å•
  - ç¡®ä¿æ‰€æœ‰å¹³ä»“è®¢å•éƒ½å¸¦"CLOSE"æ ‡è®°
- **æŠ€æœ¯åŽŸç†**:
  - QuantConnectçš„`Liquidate()`åªæŽ¥å—symbolå‚æ•°,ä¸æ”¯æŒè‡ªå®šä¹‰tag
  - `MarketOrder()`æ”¯æŒtagå‚æ•°,å¯æ­£ç¡®æ ‡è®°è®¢å•
  - `get_exit_time()`ä¾èµ–Tagä¸­çš„"CLOSE"æ ‡è®°æ¥è¿½è¸ªå¹³ä»“æ—¶é—´

**é¢„æœŸæ•ˆæžœ**:
- AMZNäº¤æ˜“æ¬¡æ•°è¿›ä¸€æ­¥é™ä½Žåˆ°4-6æ¬¡
- Cooldownåˆè§„çŽ‡: 100%
- 9/4â†’9/5çš„è¿è§„å°†è¢«æ¶ˆé™¤

**éªŒè¯æ–¹æ³•**: è¿è¡Œç›¸åŒå›žæµ‹,æ£€æŸ¥:
1. æ—¥å¿—ä¸­æ‰€æœ‰å¹³ä»“è®¢å•éƒ½æœ‰"CLOSE"æ ‡è®°
2. æ— ä»»ä½•1-2å¤©cooldownè¿è§„
3. AMZNäº¤æ˜“æ¬¡æ•°â‰¤6æ¬¡

**ç¬¬ä¸‰æ¬¡å›žæµ‹éªŒè¯** (2025å¹´9æœˆ30æ—¥):
- **å›žæµ‹ID**: `35554859263c8c008df178addc7e29d6`
- **éªŒè¯ç»“æžœ**: âœ… **å®Œå…¨æˆåŠŸ!**

| éªŒè¯é¡¹ | é¢„æœŸç›®æ ‡ | å®žé™…ç»“æžœ | çŠ¶æ€ |
|-------|---------|---------|------|
| AMZNäº¤æ˜“æ¬¡æ•° | â‰¤6æ¬¡ | **5æ¬¡** | âœ… è¶…é¢„æœŸ |
| Cooldownè¿è§„ | 0æ¬¡ | **0æ¬¡** | âœ… å®Œç¾Ž |
| Cooldownåˆè§„çŽ‡ | 100% | **100%** | âœ… å®Œç¾Ž |
| 9/4â†’9/5è¿è§„ | æ¶ˆé™¤ | **å·²æ¶ˆé™¤** | âœ… ä¿®å¤ |

**å…³é”®éªŒè¯ - 9/4å¼ºåˆ¶æ¸…ç®—æ¡ˆä¾‹**:
```
ç¬¬äºŒæ¬¡å›žæµ‹(ä¿®å¤å‰):
  9/4: AMZN-GMå¼ºåˆ¶æ¸…ç®—
  9/5: AMZN-GMç«‹å³å¼€ä»“ âŒ è¿åcooldown

ç¬¬ä¸‰æ¬¡å›žæµ‹(ä¿®å¤åŽ):
  9/4: AMZN-GMå¼ºåˆ¶æ¸…ç®—
  9/5: AMZN-CMGå¼€ä»“ âœ… ä¸åŒé…å¯¹,åˆè§„
       AMZN-GMä»åœ¨cooldown âœ… æ­£ç¡®é˜»æ­¢
```

**ä¸‰æ¬¡å›žæµ‹æ”¹å–„è½¨è¿¹**:
- ç¬¬ä¸€æ¬¡(ä¿®å¤å‰): 14æ¬¡äº¤æ˜“, å¤šæ¬¡è¿è§„
- ç¬¬äºŒæ¬¡(main.pyä¿®å¤): 7æ¬¡äº¤æ˜“, 1æ¬¡è¿è§„ (æ”¹å–„50%)
- ç¬¬ä¸‰æ¬¡(Pairs.pyä¿®å¤): 5æ¬¡äº¤æ˜“, 0æ¬¡è¿è§„ (æ”¹å–„64%, **å®Œå…¨ä¿®å¤**)

---

#### é—®é¢˜2: è®¢å•é‡å¤æäº¤

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¡ High
**å½±å“**: é€ æˆä¸å¿…è¦çš„äº¤æ˜“æˆæœ¬å’ŒæŒä»“æ··ä¹±

**é—®é¢˜æè¿°**:
- 8æœˆ19-20æ—¥å‡ºçŽ°è®¢å•é‡å¤æäº¤
- è®¢å•19-22å’Œ23-26å‡ ä¹Žç›¸åŒ
- å¯èƒ½æ˜¯ç³»ç»Ÿåœ¨çŸ­æ—¶é—´å†…é‡å¤è°ƒç”¨å¼€ä»“é€»è¾‘

**å½±å“æ•°æ®**:
- è‡³å°‘2ç»„é‡å¤è®¢å• (å…±8ä¸ªè®¢å•)
- æ¶‰åŠMCHP-QCOMé…å¯¹

**æ ¹æœ¬åŽŸå› **: [å¾…è°ƒæŸ¥]
- å¯èƒ½æ˜¯OnDataäº‹ä»¶é‡å…¥é—®é¢˜
- å¯èƒ½æ˜¯PairsManagerçŠ¶æ€ç®¡ç†é—®é¢˜

**ä¿®å¤æ–¹æ¡ˆ**: [å¾…è®¨è®º]

---

#### é—®é¢˜3: è®¢å•å–æ¶ˆå’Œæ‰§è¡Œå¤±è´¥

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¡ High
**å½±å“**: å¯¼è‡´å­¤å„¿æŒä»“(å•è¾¹æŒä»“)é£Žé™©

**é—®é¢˜æè¿°**:
- è®¢å•#38 (GM) çŠ¶æ€ä¸º"cancelPending"
- å¯èƒ½å¯¼è‡´AMZN-GMé…å¯¹åªæœ‰ä¸€è¾¹æˆäº¤

**å½±å“æ•°æ®**:
- è‡³å°‘1ä¸ªè®¢å•è¢«å–æ¶ˆ
- AMZN-GMé…å¯¹å¯èƒ½å­˜åœ¨ä¸å®Œæ•´æŒä»“

**æ ¹æœ¬åŽŸå› **: [å¾…è°ƒæŸ¥]
- å¯èƒ½æ˜¯å¸‚åœºæµåŠ¨æ€§é—®é¢˜
- å¯èƒ½æ˜¯è®¢å•æäº¤æ—¶æœºé—®é¢˜

**ä¿®å¤æ–¹æ¡ˆ**: [å¾…è®¨è®º]

---

### ðŸŸ¡ ä¼˜å…ˆçº§2 - ç­–ç•¥ç¼ºé™· (å½±å“æ”¶ç›Š)

#### é—®é¢˜4: è¡Œä¸šé›†ä¸­åº¦è¶…æ ‡

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¡ High
**å½±å“**: è¡Œä¸šé£Žé™©è¿‡åº¦é›†ä¸­,è¿åé£ŽæŽ§è§„åˆ™

**é—®é¢˜æ•°æ®**:
- ç§‘æŠ€/åŠå¯¼ä½“è‚¡ç¥¨: ~60%æš´éœ² (é…ç½®é™åˆ¶40%)
- æ¶‰åŠè‚¡ç¥¨: MCHP, QCOM, CSCO, ALGM
- æœªè§è¡Œä¸šè°ƒæ•´æ‰§è¡Œè®°å½•

**æ ¹æœ¬åŽŸå› **: [å¾…è°ƒæŸ¥]
- `check_sector_concentration()` è¢«è°ƒç”¨ä½†æœªç”Ÿæ•ˆ
- å¯èƒ½è¿”å›žéœ€è°ƒæ•´çš„é…å¯¹,ä½†æœªå®žé™…æ‰§è¡Œè°ƒæ•´
- main.py:232-242çš„è°ƒæ•´é€»è¾‘å¯èƒ½æœ‰é—®é¢˜

**ä¿®å¤æ–¹æ¡ˆ**: [å¾…è®¨è®º]

---

#### é—®é¢˜5: è´¨é‡è¯„åˆ†å¯èƒ½å­˜åœ¨åå‘

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¢ Medium
**å½±å“**: é…å¯¹é€‰æ‹©ä¸å¤Ÿå¤šæ ·åŒ–

**é—®é¢˜æè¿°**:
- AMZN (å¤§å¸‚å€¼) è¢«è¿‡åº¦é€‰ä¸­
- å¯èƒ½æ˜¯æµåŠ¨æ€§è¯„åˆ†è¿‡é«˜å¯¼è‡´
- æˆ–è€…æ˜¯è´¨é‡è¯„åˆ†åå‘å¤§å¸‚å€¼è‚¡ç¥¨

**å½±å“æ•°æ®**:
- AMZNå‡ºçŽ°åœ¨2-3ä¸ªä¸åŒé…å¯¹ä¸­
- å…¶ä»–è‚¡ç¥¨ç›¸å¯¹åˆ†æ•£

**æ ¹æœ¬åŽŸå› **: [å¾…è°ƒæŸ¥]
- è´¨é‡è¯„åˆ†ç®—æ³•å¯èƒ½åå‘:
  - æµåŠ¨æ€§æŒ‡æ ‡ (20%æƒé‡,å¤§å¸‚å€¼è‚¡ç¥¨å ä¼˜)
  - æ³¢åŠ¨çŽ‡æ¯”çŽ‡ (å¤§å¸‚å€¼è‚¡ç¥¨æ›´ç¨³å®š)

**ä¿®å¤æ–¹æ¡ˆ**: [å¾…è®¨è®º]

---

### ðŸŸ¢ ä¼˜å…ˆçº§3 - ç­–ç•¥ä¼˜åŒ– (æå‡æ€§èƒ½)

#### é—®é¢˜6: ä¿¡å·é˜ˆå€¼å¯èƒ½è¿‡äºŽæ•æ„Ÿ

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¢ Medium
**å½±å“**: äº¤æ˜“é¢‘çŽ‡åé«˜,å¯èƒ½äº§ç”Ÿå‡ä¿¡å·

**é—®é¢˜æ•°æ®**:
- å½“å‰entry_threshold: Â±1.0Ïƒ
- å¹³å‡æŒä»“: 3-7å¤© (è¾ƒçŸ­)
- å¤šä¸ªé…å¯¹å‡ºçŽ°å¿«é€Ÿå¼€å¹³ä»“

**ä¼˜åŒ–å»ºè®®**:
- æé«˜entry_thresholdåˆ°Â±1.5Ïƒ
- è§‚å¯ŸæŒä»“æ—¶é•¿å’ŒèƒœçŽ‡å˜åŒ–

---

#### é—®é¢˜7: æ­¢æŸé˜ˆå€¼å¯èƒ½è¿‡äºŽå®½æ¾

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¢ Medium
**å½±å“**: å•ç¬”äºæŸå¯èƒ½è¿‡å¤§

**é—®é¢˜æ•°æ®**:
- å½“å‰stop_threshold: Â±3.0Ïƒ
- å¤šä¸ªé…å¯¹å‡ºçŽ°10%+æµ®äºæ‰æ­¢æŸ

**ä¼˜åŒ–å»ºè®®**:
- é™ä½Žstop_thresholdåˆ°Â±2.5Ïƒ
- æ›´æ—©æ­¢æŸ,å‡å°‘å•ç¬”æŸå¤±

---

#### é—®é¢˜8: é€‰è‚¡æ± å¯èƒ½ä¸å¤Ÿå¤§

**ä¸¥é‡ç¨‹åº¦**: ðŸŸ¢ Low
**å½±å“**: é…å¯¹å¤šæ ·æ€§ä¸è¶³

**é—®é¢˜æ•°æ®**:
- å½“å‰æ¯è¡Œä¸š15åªè‚¡ç¥¨
- å¯èƒ½å¯¼è‡´é…å¯¹é€‰æ‹©å—é™

**ä¼˜åŒ–å»ºè®®**:
- æé«˜åˆ°æ¯è¡Œä¸š20åªè‚¡ç¥¨
- å¢žåŠ é…å¯¹å¤šæ ·æ€§

---

## é—®é¢˜è§£å†³è¿›åº¦

| é—®é¢˜ | çŠ¶æ€ | è´Ÿè´£æ¨¡å— | é¢„è®¡å·¥ä½œé‡ |
|------|------|----------|-----------|
| ~~é—®é¢˜1: Cooldownå¤±æ•ˆ~~ | âœ… å·²ä¿®å¤ | main.py | 1å°æ—¶ |
| é—®é¢˜2: è®¢å•é‡å¤ | ðŸŸ¡ å¾…è°ƒæŸ¥ | main.py, PairsManager.py | 4å°æ—¶ |
| é—®é¢˜3: è®¢å•å–æ¶ˆ | ðŸŸ¡ å¾…è°ƒæŸ¥ | Pairs.py | 2å°æ—¶ |
| é—®é¢˜4: è¡Œä¸šé›†ä¸­åº¦ | ðŸŸ¡ å¾…è°ƒæŸ¥ | main.py | 2å°æ—¶ |
| é—®é¢˜5: è´¨é‡è¯„åˆ†åå‘ | ðŸŸ¢ å¾…è¯„ä¼° | PairSelector.py | 4å°æ—¶ |
| é—®é¢˜6: ä¿¡å·é˜ˆå€¼ | ðŸŸ¢ å¾…æµ‹è¯• | config.py | 1å°æ—¶ |
| é—®é¢˜7: æ­¢æŸé˜ˆå€¼ | ðŸŸ¢ å¾…æµ‹è¯• | config.py | 1å°æ—¶ |
| é—®é¢˜8: é€‰è‚¡æ±  | ðŸŸ¢ å¾…è¯„ä¼° | config.py | 1å°æ—¶ |

---

## ä¿®å¤éªŒè¯æ ‡å‡†

### é—®é¢˜1éªŒè¯æ ‡å‡†:
- [ ] æ‰€æœ‰é…å¯¹å¹³ä»“åŽcooldownç”Ÿæ•ˆ
- [ ] AMZNç±»è‚¡ç¥¨äº¤æ˜“æ¬¡æ•°â‰¤8æ¬¡
- [ ] æ— è¿åcooldownè§„åˆ™çš„äº¤æ˜“

### é—®é¢˜4éªŒè¯æ ‡å‡†:
- [ ] ä»»æ„æ—¶åˆ»å•è¡Œä¸šæš´éœ²â‰¤40%
- [ ] å‡ºçŽ°è¶…æ ‡æ—¶æœ‰è°ƒæ•´æ‰§è¡Œè®°å½•
- [ ] ç§‘æŠ€è‚¡æš´éœ²â‰¤40%

---

## å›žæµ‹æ”¹è¿›ç›®æ ‡

**çŸ­æœŸç›®æ ‡** (ä¿®å¤ä¼˜å…ˆçº§1é—®é¢˜åŽ):
- 3ä¸ªæœˆæ”¶ç›ŠçŽ‡: 0% ~ +2%
- æœ€å¤§å›žæ’¤: â‰¤3%
- AMZNäº¤æ˜“æ¬¡æ•°: â‰¤8æ¬¡
- æ— cooldownè¿è§„

**ä¸­æœŸç›®æ ‡** (ä¿®å¤ä¼˜å…ˆçº§1+2é—®é¢˜åŽ):
- 3ä¸ªæœˆæ”¶ç›ŠçŽ‡: +3% ~ +5%
- Sharpeæ¯”çŽ‡: >0.8
- è¡Œä¸šé›†ä¸­åº¦åˆè§„çŽ‡: 100%
- è®¢å•æ‰§è¡ŒæˆåŠŸçŽ‡: >98%

**é•¿æœŸç›®æ ‡** (å…¨éƒ¨ä¼˜åŒ–å®ŒæˆåŽ):
- 6-12ä¸ªæœˆå›žæµ‹éªŒè¯
- å¹´åŒ–æ”¶ç›ŠçŽ‡: >10%
- Sharpeæ¯”çŽ‡: >1.2
- æœ€å¤§å›žæ’¤: <10%

---

## å¤‡æ³¨

- æœ¬æ–‡æ¡£éšé—®é¢˜ä¿®å¤åŠ¨æ€æ›´æ–°
- å·²è§£å†³é—®é¢˜æ ‡è®°~~åˆ é™¤çº¿~~
- æ–°å‘çŽ°é—®é¢˜æŒ‰ä¼˜å…ˆçº§æ’å…¥å¯¹åº”ç« èŠ‚